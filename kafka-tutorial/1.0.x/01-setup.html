<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Setup :: Kafka Tutorial</title>
    <link rel="canonical" href="https://redhat-cloud-services-tmm.github.io/kafka-tutorial/kafka-tutorial/1.0.x/01-setup.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="02-topics-partitions.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-cloud-services-tmm.github.io/kafka-tutorial">Kafka Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="kafka-tutorial" data-version="1.0.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#prerequisite">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#downloadconfiguresources">Download &amp; Configure Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#redhataccount">Create a Red Hat Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#kafka">Provision a Kafka Instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#serviceaccount">Create a Service Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#serviceaccountpermissions">Set Permissions for the Service Account</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#verifykafka">Verify the Kafka instance</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-topics-partitions.html">2. Topics &amp; Partitions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-topics-partitions.html#topics">Topics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-topics-partitions.html#partitions">Partitions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-topics-partitions.html#messages">Messages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-topics-partitions.html#topic-creation">Create a Topic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-topics-partitions.html#topic-info">Topic Information</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-consumers-producers.html">3. Consumer &amp; Producers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#producer">Producer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#consumer">Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#consume-kafkacat">Kafkacat Consumer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#produce-kafkacat">Kafkacat Producer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#playingwithoffsets">Kafkacat Offsets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-consumers-producers.html#changingretention">Changing Retention</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-java-consumer-producer.html">4. Developing Consumers and Producers in Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-java-consumer-producer.html#topic-creation">Create a Topic</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-java-consumer-producer.html#producer-java">Producing messages with Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-java-consumer-producer.html#deploying-producer">Deploying Producer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-java-consumer-producer.html#consumer-java">Consuming messages with Java</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-java-consumer-producer.html#deploying-consumer">Deploying Consumer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-java-consumer-producer.html#produce-consume-songs">Produce and Consume Songs</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Kafka Tutorial</a></li>
    <li><a href="01-setup.html">1. Setup</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Setup</h1>
<div class="sect1">
<h2 id="prerequisite"><a class="anchor" href="#prerequisite"></a>Prerequisite CLI tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following CLI tools are required for running the exercises in this tutorial.
Please have them installed and configured before you get started with any of the tutorial chapters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top"><strong>Tool</strong></th>
<th class="tableblock halign-center valign-top"><strong>macOS</strong></th>
<th class="tableblock halign-center valign-top"><strong>Fedora</strong></th>
<th class="tableblock halign-center valign-top"><strong>windows</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Git</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://git-scm.com/download/mac">Download</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://git-scm.com/download/linux">Download</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://git-scm.com/download/win">Download</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Docker</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://docs.docker.com/docker-for-mac/install">Docker for Mac</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>dnf install docker</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://docs.docker.com/docker-for-windows/install">Docker for Windows</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Kcat</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://github.com/edenhill/kcat">Download</a> or <code>brew install kcat</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://github.com/edenhill/kcat">Download</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://github.com/edenhill/kcat">Download</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://httpie.org/">httpie</a></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>brew install httpie</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>dnf install httpie</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><a href="https://httpie.org/doc#windows-etc" class="bare">https://httpie.org/doc#windows-etc</a></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
An alternative for running <code>kcat</code> is to use the following Docker command and image  <code>docker run -it edenhill/kcat:1.7.0 kcat</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="downloadconfiguresources"><a class="anchor" href="#downloadconfiguresources"></a>Download &amp; Configure Tutorial Sources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we start setting up the environment, let’s clone the tutorial sources and set the <code>TUTORIAL_HOME</code> environment variable to point to the root directory of the tutorial:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone <a href="https://github.com/redhat-cloud-services-tmm/kafka-tutorial.git" class="bare">https://github.com/redhat-cloud-services-tmm/kafka-tutorial.git</a> kafka-tutorial</code></pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export TUTORIAL_HOME="$(pwd)/kafka-tutorial"</code></pre>
</div>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $TUTORIAL_HOME</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="redhataccount"><a class="anchor" href="#redhataccount"></a>Create a Red Hat account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need a Red Hat account to provision a managed Kafka instance. If you don’t have a Red Hat account, this is how you can create one:</p>
</div>
<div class="paragraph">
<p>Go to <a href="https://console.redhat.com">console.redhat.com</a>.</p>
</div>
<div class="paragraph">
<p>Click the <strong>Register for a Red Hat account</strong> link to create a Red Hat account.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/register-redhat-account.png" alt="register redhat account" width="60%">
</div>
</div>
<div class="paragraph">
<p>Be sure to select a <strong>Personal account</strong> type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kafka"><a class="anchor" href="#kafka"></a>Provision a Kafka instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Go to <a href="https://console.redhat.com">console.redhat.com</a> and log in with your Red Hat account.</p>
</div>
<div class="paragraph">
<p>On the <a href="https://console.redhat.com">console.redhat.com</a> landing page, select <strong>Application Services</strong> from the menu on the left.</p>
</div>
<div class="paragraph">
<p>On the Application Services landing page, select <strong>Streams for Apache Kafka → Kafka Instances</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/rhosak-kafka-instances.png" alt="rhosak kafka instances">
</div>
</div>
<div class="paragraph">
<p>On the Kafka Instances overview page, click the <strong>Create Kafka</strong> instance button. Choose a name and a region for your Kafka instance and click <strong>Create instance</strong>. From there, a managed Kafka instance will be provisioned for you. After a couple of minutes, your instance should be marked as ready.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/rhosak-kafka-instance-ready.png" alt="rhosak kafka instance ready">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="serviceaccount"><a class="anchor" href="#serviceaccount"></a>Create a Service Account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To connect your applications or services to a Streams for Apache Kafka instance, you need to create a service account.</p>
</div>
<div class="paragraph">
<p>On the <strong>Kafka Instances</strong> overview page, select the <strong>Options</strong> icon (the three dots) for the Kafka instance you just created. Select <strong>View connection information</strong>.</p>
</div>
<div class="paragraph">
<p>Copy the <strong>Bootstrap server</strong> endpoint to a secure location. You will need this when connecting to your Kafka instance.</p>
</div>
<div class="paragraph">
<p>Click <strong>Create service account</strong> to set up the service account. Enter a unique service account name and an optional description, and click <strong>Create</strong>.</p>
</div>
<div class="paragraph">
<p>Copy the generated <strong>Client ID</strong> and <strong>Client Secret</strong> to a secure location. These are the credentials that you’ll use to connect to this Kafka instance.</p>
</div>
<div class="paragraph">
<p>After saving the generated credentials, select the confirmation check box and close the Credentials window.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/rhosak-service-account.png" alt="rhosak service account">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="serviceaccountpermissions"><a class="anchor" href="#serviceaccountpermissions"></a>Set Permissions for the Service Account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After you create a service account to connect to a Kafka instance, you must also set the appropriate level of access for that new account in the Access Control List (ACL) of the Kafka instance. OpenShift Streams for Apache Kafka uses ACLs provided by Kafka that enable you to manage how other user accounts and service accounts are permitted to interact with the Kafka resources that you create.</p>
</div>
<div class="paragraph">
<p>On the <strong>Kafka Instances</strong> page, click the name of the Kafka instance you created before.</p>
</div>
<div class="paragraph">
<p>Click the <strong>Access</strong> tab to view the current ACL for this instance.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/rhosak-default-access.png" alt="rhosak default access">
</div>
</div>
<div class="paragraph">
<p>Click <strong>Manage access</strong>, use the <strong>Account</strong> drop-down menu to select the service account that you previously created, and click <strong>Next</strong>.</p>
</div>
<div class="paragraph">
<p>Under <strong>Assign Permissions</strong>, use the drop-down menus to set the permissions shown in the following table for this service account. Click <strong>Add</strong> to add each new resource permission.</p>
</div>
<div class="paragraph">
<p>These permissions enable applications associated with the service account to create and delete topics in the instance, to produce and consume messages in any topic in the instance, and to use any consumer group and any producer.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Example ACL permissions for a new service account</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Resource type</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Resource identifier and value</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Access type</p></th>
<th class="tableblock halign-left valign-top"><p class="tableblock">Operation</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Is</code> = <code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Allow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>All</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Consumer group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Is</code> = <code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Allow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Read</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Transactional ID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Is</code> = <code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Allow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>All</code></p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="_images/rhosak-access-serviceaccount.png" alt="rhosak access serviceaccount">
</div>
</div>
<div class="paragraph">
<p>After you add these permissions for the service account, click <strong>Save</strong> to finish.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verifykafka"><a class="anchor" href="#verifykafka"></a>Verify the Kafka instance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using your preferred text editor, open the file at <code>$TUTORIAL_HOME/apps/env</code>. Replace the placeholders with the values you copied before. Save the file.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">BOOTSTRAP_SERVER=&lt;Kafka bootstrap url&gt;

CLIENT_ID=&lt;service account client id&gt;

CLIENT_SECRET=&lt;service account client secret&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open a new terminal to run Kafka commands.</p>
</div>
<div class="paragraph">
<p>Source the environment file to set the environment variables for the Kafka instance bootstrap URL, and the service account ID and secret.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash-shell hljs" data-lang="bash-shell">source $TUTORIAL_HOME/apps/env</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that the Kafka instance is correctly started and configured by running the following command:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_kcat"></a>kcat</p>
</li>
<li>
<p><a id="tabset1_kcat-in-docker"></a>kcat in Docker</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_kcat">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash-shell hljs" data-lang="bash-shell">kcat -b $BOOTSTRAP_SERVER -X security.protocol=SASL_SSL -X sasl.mechanisms=PLAIN -X sasl.username="$CLIENT_ID" -X sasl.password="$CLIENT_SECRET" -L</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_kcat-in-docker">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash-shell hljs" data-lang="bash-shell">docker run --rm -it edenhill/kcat:1.7.0 -b $BOOTSTRAP_SERVER -X security.protocol=SASL_SSL -X sasl.mechanisms=PLAIN -X sasl.username="$CLIENT_ID" -X sasl.password="$CLIENT_SECRET" -L</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Metadata for all topics (from broker -1: sasl_ssl://bernard-tm-c-mmjsvmjpm-c--rskqa.bf2.kafka.rhcloud.com:443/bootstrap):
 3 brokers:
  broker 0 at broker-0-bernard-tm-c-mmjsvmjpm-c--rskqa.bf2.kafka.rhcloud.com:443
  broker 2 at broker-2-bernard-tm-c-mmjsvmjpm-c--rskqa.bf2.kafka.rhcloud.com:443
  broker 1 at broker-1-bernard-tm-c-mmjsvmjpm-c--rskqa.bf2.kafka.rhcloud.com:443 (controller)
 0 topics:</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Kafka Tutorial</a></span>
  <span class="next"><a href="02-topics-partitions.html">2. Topics &amp; Partitions</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
